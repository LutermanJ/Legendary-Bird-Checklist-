<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Legendary Birds Checklist</title>
<style>
body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; margin: 0; padding: 0.75rem; }
h1 { font-size: 1.1rem; margin: 0 0 0.5rem; }
h2 { font-size: 1rem; margin: 1rem 0 0.5rem; }
section { margin-bottom: 1rem; }
ul { list-style: none; padding: 0; margin: 0; }
li { margin: 0; padding: 0.2rem 0; }
label { display: flex; flex-wrap: wrap; align-items: center; line-height: 1.2; }
input[type=checkbox] { width: 18px; height: 18px; margin-right: 0.5rem; }
.toolbar { position: sticky; top: 0; background:#fff; padding: .5rem; border-bottom: 1px solid #eee; z-index: 10; display:flex; gap:.4rem; flex-wrap:wrap; align-items:center; }
.toolbar button, .toolbar input, .toolbar select { padding: .45rem .6rem; border: 1px solid #ccc; border-radius: 8px; background: #f8f8f8; font-size: .9rem; }
.toolbar input[type=search] { flex: 1 1 160px; background:#fff; }
.tag { font-size: .75rem; opacity:.75; margin-left:.35rem; }
small.hint { display:block; color:#666; margin-top:.2rem; }
#saveStatus { margin-left:auto; font-size:.9rem; color:#1a7f37; }
#storageWarning { display:none; margin-top:.25rem; padding:.45rem .6rem; border:1px solid #f5c2c7; border-radius:8px; background:#fff5f6; color:#7a3035; width:100%; }
@media (prefers-color-scheme: dark) {
  body { background:#0f1115; color:#e6e6e6; }
  h1, h2 { color:#fff; }
  .toolbar { background:#0f1115; border-color:#333; }
  .toolbar button, .toolbar input, .toolbar select { background:#1a1d24; color:#e6e6e6; border-color:#333; }
  .tag { color:#c7c7c7; }
  #storageWarning { background:#2a1113; border-color:#7a3035; color:#f4d7da; }
}
.hidden { display:none !important; }
.counter { font-size:.85rem; opacity:.8; margin-left:.4rem; }
#globalCounter { margin-left:auto; font-weight:600; }
.add-form { width:100%; display:none; gap:.4rem; margin-top:.35rem; }
.add-form input[type=text] { flex:1 1 220px; }
.add-form select, .add-form input, .add-form button { padding:.45rem .6rem; border:1px solid #ccc; border-radius:8px; background:#f8f8f8; }
.add-row { display:flex; flex-wrap:wrap; gap:.4rem; width:100%; }
.add-toggle { margin-left:.2rem; }
</style>
</head>
<body>

<h1>Legendary Birds Checklist</h1>
<div class="toolbar">
  <input type="search" id="q" placeholder="Search name, set, number…">
  <select id="langFilter">
    <option value="all">All langs</option>
    <option value="EN">English only</option>
    <option value="JP">Japanese only</option>
  </select>
  <button id="btnAdd" class="add-toggle">Add card</button>
  <div class="add-form" id="addForm">
    <div class="add-row">
      <select id="addSection"></select>
      <input type="text" id="addText" placeholder="Card line (e.g., Zapdos — Set — 16/102 — Holo — EN)">
      <select id="addLang"><option value="EN">EN</option><option value="JP">JP</option></select>
      <button id="addSubmit">Add</button>
    </div>
  </div>
  <button id="btnExport">Export</button>
  <button id="btnImport">Import</button>
  <input type="file" id="importFile" accept=".json" style="display:none">
  <button id="btnClear">Clear</button>
  <span id="saveStatus"></span>
  <div id="storageWarning">Safari preview can’t save data. Open this link in Safari, then Share → Add to Home Screen to persist checkmarks.</div>
  <span id="globalCounter">0 / 0</span>
</div>

<!-- Example section - repeat for Zapdos, Articuno, Moltres with all list items -->
<section>
<h2>Zapdos <span class="counter">(0 / 0)</span></h2>
<ul>
<li data-lang="EN"><label><input type="checkbox" data-key="zapdos-base-holo">Zapdos — Base Set — 16/102 — Holo — EN</label></li>
<li data-lang="EN"><label><input type="checkbox" data-key="zapdos-base-nonholo">Zapdos — Base Set — 16/102 — Non-Holo — EN</label></li>
</ul>
</section>

<script>
const STORAGE_PREFIX = 'legendaryBirds_';
const STORAGE_OK = (()=>{try{localStorage.setItem('_test','1');localStorage.removeItem('_test');return true;}catch(e){return false;}})();
function hashKey(s){ let h=0; for(let i=0;i<s.length;i++){ h=((h<<5)-h)+s.charCodeAt(i); h|=0; } return (h>>>0).toString(16); }
function flashSaved(){const s=document.getElementById('saveStatus');if(!s)return;s.textContent='Saved';setTimeout(()=>s.textContent='',800);}
function recount(){
  let total=0, checked=0;
  document.querySelectorAll('section').forEach(sec=>{
    const lis=sec.querySelectorAll('li');
    let t=0,c=0;
    lis.forEach(li=>{
      const cb=li.querySelector('input[type=checkbox]');
      if(!cb) return;
      t++; if(cb.checked) c++;
    });
    const ctr=sec.querySelector('h2 .counter');
    if(ctr) ctr.textContent=`(${c} / ${t})`;
    total+=t; checked+=c;
  });
  document.getElementById('globalCounter').textContent=`${checked} / ${total}`;
}
function wireCheckbox(cb){
  const key=STORAGE_PREFIX+cb.dataset.key;
  const saved=STORAGE_OK?localStorage.getItem(key):null;
  cb.checked=(saved==='1');
  cb.closest('li')?.classList.toggle('checked',cb.checked);
  cb.addEventListener('change',()=>{
    if(STORAGE_OK){localStorage.setItem(key,cb.checked?'1':'0');flashSaved();}
    cb.closest('li')?.classList.toggle('checked',cb.checked);
    recount();
  });
}
document.querySelectorAll('input[type=checkbox][data-key]').forEach(wireCheckbox);
(function(){
  const q=document.getElementById('q');
  const langSel=document.getElementById('langFilter');
  function applyFilters(){
    const needle=(q?.value||'').toLowerCase();
    const wantLang=langSel?.value||'all';
    document.querySelectorAll('section li').forEach(li=>{
      const txt=li.textContent.toLowerCase();
      const lang=li.getAttribute('data-lang')||'all';
      const matchText=!needle||txt.includes(needle);
      const matchLang=(wantLang==='all')||(lang===wantLang);
      li.classList.toggle('hidden',!(matchText&&matchLang));
    });
  }
  q?.addEventListener('input',applyFilters);
  langSel?.addEventListener('change',applyFilters);
  applyFilters();
})();
(function(){
  const CUSTOM_KEY='bird_custom_items_v1';
  const btnAdd=document.getElementById('btnAdd');
  const form=document.getElementById('addForm');
  const submit=document.getElementById('addSubmit');
  const secSel=document.getElementById('addSection');
  const addText=document.getElementById('addText');
  const addLang=document.getElementById('addLang');
  document.querySelectorAll('section h2').forEach(sec=>{
    const opt=document.createElement('option');
    opt.value=sec.childNodes[0].textContent.trim();
    opt.textContent=sec.childNodes[0].textContent.trim();
    secSel.appendChild(opt);
  });
  btnAdd?.addEventListener('click',()=>{form.style.display=(form.style.display==='none'||!form.style.display)?'flex':'none';});
  function saveCustomList(list){try{localStorage.setItem(CUSTOM_KEY,JSON.stringify(list));}catch(e){}}
  function loadCustomList(){try{return JSON.parse(localStorage.getItem(CUSTOM_KEY)||'[]');}catch(e){return[];}}
  function addOneCustom(item){
    const sec=Array.from(document.querySelectorAll('section')).find(s=>s.querySelector('h2')?.textContent.trim().startsWith(item.section));
    if(!sec) return;
    const ul=sec.querySelector('ul');
    const li=document.createElement('li');
    li.setAttribute('data-lang',item.lang||'EN');
    const label=document.createElement('label');
    const cb=document.createElement('input');
    cb.type='checkbox';
    cb.dataset.key=item.key;
    cb.id='cb_'+item.key;
    label.setAttribute('for',cb.id);
    label.appendChild(cb);
    label.appendChild(document.createTextNode(' '+item.text));
    li.appendChild(label);
    ul.appendChild(li);
    wireCheckbox(cb);
  }
  loadCustomList().forEach(addOneCustom);
  submit?.addEventListener('click',()=>{
    const sectionName=secSel.value;
    let text=(addText.value||'').trim();
    const lang=addLang.value||'EN';
    if(!text){alert('Please enter the card line.');return;}
    if(!/ — (EN|JP)$/.test(text)) text+=` — ${lang}`;
    const key=hashKey(sectionName+'::'+text);
    const item={section:sectionName,text,lang,key};
    const list=loadCustomList();list.push(item);saveCustomList(list);
    addOneCustom(item);
    addText.value='';form.style.display='none';recount();
  });
})();
window.addEventListener('load', recount);
</script>
</body>
</html>
